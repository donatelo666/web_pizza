<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Menu</title>
    <!--union con el css , fuente de google "lemon" , union con bootstrap-->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Lemon&family=Sigmar&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />
        <link rel="stylesheet" href="/css/estilo_menu.css" />

   
  </head>

  <body>

    <!--navbar en partials-->
    <%- include('partials/navbar') %>
    <!--header con css -->
    <header class="head">
      <p>MENU TMNT PIZZA</p>
    </header>
    <!--textos simples con css-->
    <section class="menu1">
      <p class="texto1">selecciona entre personal, mediana y familiar</p>
      <p class="texto2">$20.000</p>
      <p class="texto3">$50.000</p>
      <p class="texto4">$65.000</p>
    </section>
    <!--carrusel de bootstrap, tipo transicion slide ,pone contenedor para las imgenes,
     agrega imagenes primera en active , en block , tamaño 100%,
    descripcion 3 veces  -->
    <div id="carouselExample" class="carousel slide">
      <div class="carousel-inner">
        <div class="carousel-item active">
          <img
            src="/img/personal.png"
            class="d-block mx-auto"
            alt="pizza personal"
          />
        </div>
        <div class="carousel-item">
          <img
            src="/img/mediana.png"
            class="d-block mx-auto"
            alt="pizza mediana"
          />
        </div>
        <div class="carousel-item">
          <img
            src="/img/familiar.png"
            class="d-block mx-auto"
            alt="pizza familiar"
          />
        </div>
      </div>
      <!--agrega los dos botones , prev y next, indica su carrusel "carruselexample", 
        pone los iconos"carrusel control prev icon" -->
      <button
        class="carousel-control-prev"
        type="button"
        data-bs-target="#carouselExample"
        data-bs-slide="prev"
      >
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button
        class="carousel-control-next"
        type="button"
        data-bs-target="#carouselExample"
        data-bs-slide="next"
      >
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
    <!-- texto simple con css -->
    <section class="menu3">
      <p class="texto5">Ahora escoge uno de nuestros sabores...</p>
    </section>

    <!--carrusel con bootstrap que se genera desde la base de datos -->
    <div id="carouselpizza" class="carousel slide" >
  
  <!-- Indicadores
   Genera un botón indicador por cada pizza en el arreglo,
Marca el primero como activo,
Asigna correctamente los atributos para que Bootstrap lo entienda. -->
  <div class="carousel-indicators">
    <% pizzas.forEach((pizza, index) => { %>
      <button 
        type="button" 
        data-bs-target="#carouselpizza" 
        data-bs-slide-to="<%= index %>" 
        class="<%= index === 0 ? 'active' : '' %>" 
        <%= index === 0 ? 'aria-current="true"' : '' %> 
        aria-label="Slide <%= index + 1 %>">
      </button>
    <% }); %>
  </div>

  <!-- Slides; genera las diapositivas de las pizzas con nombre e ingredientes
   , pone la primera en activo usando la base de datos -->
  <div class="carousel-inner">
    <% pizzas.forEach((pizza, index) => { %>
      <div class="carousel-item <%= index === 0 ? 'active' : '' %>">
        <img 
          src="<%= pizza.ruta_imagen %>" 
          class="d-block mx-auto" 
          alt="Pizza <%= pizza.nombre %>">
        <div class="carousel-caption d-none d-md-block">
          <h5><%= pizza.nombre %></h5>
          <p><%= pizza.ingredientes %></p>
        </div>
      </div>
    <% }); %>
  </div>

  <!-- Controles del carrusel-->
  <button class="carousel-control-prev" type="button" data-bs-target="#carouselpizza" data-bs-slide="prev">
    <span class="carousel-control-prev-icon"></span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselpizza" data-bs-slide="next">
    <span class="carousel-control-next-icon"></span>
  </button>
</div>

    

    <!--footer con tres botones y css-->
    <footer class="footer_menu">
      <a href="/inicio" class="regresa-btn">Inicio</a>
      <a href="/contacto" class="ordena-btn"
        >Contacto, registro y login</a
      >
      
    </footer>

     <!--script que escucha el click del boton ordenar ,  notificacion que desaparece
    despues de diez segundos, frena el avance si el usuario no es cliente ni admin -->
    <script>
      function mostrarNotificacion() {
        const mensaje = `✅ Debes iniciar sesión para ordenar,<br>Si no tienes una cuenta<br> debes registrarte`;
        const notificacion = document.getElementById("notificacion");
        notificacion.innerHTML = mensaje;
        notificacion.classList.remove("oculto");
        notificacion.classList.add("visible");

        setTimeout(() => {
          notificacion.classList.remove("visible");
          notificacion.classList.add("oculto");
        }, 10000);
      }

      document.getElementById("irOrdenar").addEventListener("click", (e) => {
        if (!localStorage.getItem("token")) {
          e.preventDefault(); // ⛔ detiene el comportamiento por defecto (como ir al href)
          mostrarNotificacion(); // ✅ muestra la notificacion
          return; 
        }

        // ✅  ir a ordenar pestaña
        window.location.href = "/editar";
      });
    </script>

    <!--div de la notificacion para mostrarla en pantalla-->
    <div id="notificacion" class="oculto"></div>


    <script>
  function mostrarNotificacion4() {
    const mensaje = `✅ Sesión cerrada<br>Nos veremos pronto`;
    const notificacion = document.getElementById("Notificacion4");
    notificacion.innerHTML = mensaje;
    notificacion.classList.remove("oculto");
    notificacion.classList.add("visible");

    // Ocultar después de 10 segundos
    setTimeout(() => {
      notificacion.classList.remove("visible");
      notificacion.classList.add("oculto");
    }, 10000);
  }

  // Escucha el clic en el botón logout
  document.getElementById("logout").addEventListener("click", () => {
    localStorage.removeItem("token");
    mostrarNotificacion4();

    
  });
</script>
<!--div de cerrar sesion -->
    <div id="Notificacion4" class="oculto"></div>


    <!--script de bootstrap-->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
